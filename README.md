# RL Policy Importer Tool

A toolkit for importing trained reinforcement learning policies into MATLAB format for use in Simulink and other MATLAB applications.

## Overview

This tool converts PyTorch-based RL policies into MATLAB-compatible formats by:
1. Extracting normalization parameters from PyTorch models
2. Converting ONNX neural networks into MATLAB deep learning networks
3. Creating MATLAB RL policy objects suitable for deployment

## Tested Workflow

This script has been successfully tested for the Isaac Lab to Simulink deployment workflow. The tool enables seamless transfer of reinforcement learning policies trained in Isaac Lab (NVIDIA's robot learning framework) into Simulink for real-time simulation and hardware deployment. The conversion process preserves the neural network architecture and normalization parameters, ensuring consistent policy behavior between the training environment and the deployment platform.

## Files

- `normalizer_exporter.py` - Python script to extract normalization parameters from PyTorch models
- `policy_importer.m` - MATLAB function to import ONNX models and create RL policy objects
- `lstm/` - Example directory containing model files

## Usage

### Step 1: Export Normalizer (Python)

Run the Python script to extract normalization parameters:

```bash
python normalizer_exporter.py
```

When prompted, enter the path to your model directory (e.g., `lstm`). This will generate a `normalizer.json` file containing the mean and standard deviation for input normalization.

### Step 2: Import Policy (MATLAB)

In MATLAB, call the policy importer function:

```matlab
model_dir = "lstm";  % or your model directory path
[obsInfo, actInfo, policy, actor] = policy_importer(model_dir);
```

This will:
- Load normalization parameters from `normalizer.json`
- Import the neural network from `policy.onnx`
- Create MATLAB RL policy objects
- Generate a `policy.mat` file for Simulink use

## Required Files

Your model directory should contain:
- `policy.pt` - PyTorch JIT model with normalizer
- `policy.onnx` - ONNX format of the neural network
- `normalizer.json` - Generated by the Python script

## Requirements

### Python
- PyTorch
- JSON (standard library)

### MATLAB
- Deep Learning Toolbox
- Reinforcement Learning Toolbox

## Output

The tool generates:
- `normalizer.json` - Normalization parameters in JSON format
- `policy.mat` - MATLAB policy file ready for Simulink deployment
- MATLAB workspace variables: `obsInfo`, `actInfo`, `policy`, `actor`

## Action Bounds

By default, action bounds are set to [-130, 130]. You can customize these by modifying the `actLow` and `actHigh` parameters in the `create_actor` function call within `policy_importer.m`. 
